#!/system/bin/sh


# ==============================================================================
#                           Flux Settings Configuration
# ==============================================================================
# Note: Restart service after modifying this file
# Usage: These settings override internal defaults
# ==============================================================================


# ==============================================================================
# [ General ]
# ==============================================================================

# Subscription URL (sing-box compatible)
SUBSCRIPTION_URL=""

# Subscription download timeout (seconds)
UPDATE_TIMEOUT=15

# Download retry count
RETRY_COUNT=2

# Auto-update interval (seconds, 86400=24h, 0=Disable)
UPDATE_INTERVAL=86400


# ==============================================================================
# [ Logging ]
# ==============================================================================

# 0=OFF, 1=Error, 2=Warn, 3=Info, 4=Debug
LOG_LEVEL=3

# Max log size before rotation (bytes)
LOG_MAX_SIZE=1048576


# ==============================================================================
# [ Core ]
# ==============================================================================

# Execution user/group for sing-box
CORE_USER="root"
CORE_GROUP="root"

# Core startup timeout (seconds)
CORE_TIMEOUT=5


# ==============================================================================
# [ Proxy Mode ]
# ==============================================================================

# 0=Auto (TProxy > Redirect), 1=TProxy, 2=Redirect
PROXY_MODE=0

# DNS Hijack: 0=Disable, 1=TProxy (Mangle), 2=Redirect (NAT)
DNS_HIJACK_ENABLE=1

# DNS Local Port
DNS_PORT=1053

# Proxy Ports (Extracted from config.json)
# PROXY_TCP_PORT=1536
# PROXY_UDP_PORT=1536

# FakeIP Ranges (Extracted from config.json)
# FAKEIP_RANGE_V4="198.18.0.0/15"
# FAKEIP_RANGE_V6="fc00::/18"


# ==============================================================================
# [ Network Interfaces ]
# ==============================================================================

# Interface names (Support wildcard +)
MOBILE_INTERFACE="rmnet_data+"
WIFI_INTERFACE="wlan0"
HOTSPOT_INTERFACE="wlan2"
USB_INTERFACE="rndis+"


# ==============================================================================
# [ Proxy Scope ]
# ==============================================================================

# Interface switches (0=Bypass, 1=Proxy)
PROXY_MOBILE=1
PROXY_WIFI=1
PROXY_HOTSPOT=0
PROXY_USB=0

# Protocol switches (0=Disable, 1=Enable)
PROXY_TCP=1
PROXY_UDP=1
PROXY_IPV6=0


# ==============================================================================
# [ Routing ]
# ==============================================================================

# IPTables Table ID & Fwmarks
TABLE_ID=2025
MARK_VALUE=20
MARK_VALUE6=25

# Core/Bypass Routing Mark (empty=use UID owner match)
ROUTING_MARK=""


# ==============================================================================
# [ App Proxy ]
# ==============================================================================

# 0=Disable, 1=Blacklist (bypass specified apps), 2=Whitelist (proxy only specified apps)
APP_PROXY_MODE=0

# Package names - supports multi-line values in quotes
# Example (newlines INSIDE quotes):
# APP_LIST="com.google.android.youtube
# com.twitter.android
# com.instagram.android"
APP_LIST=""


# ==============================================================================
# [ MAC Filter ] (Hotspot only)
# ==============================================================================

# 0=Disable, 1=Blacklist (bypass specified MACs), 2=Whitelist (proxy only specified MACs)
MAC_PROXY_MODE=0

# MAC addresses (Space-separated, format AA:BB:CC:DD:EE:FF)
MAC_LIST=""


# ==============================================================================
# [ Advanced ]
# ==============================================================================

# Skip kernel feature check: 0=Check, 1=Skip
SKIP_CHECK_FEATURE=0

# IP monitor debounce interval (seconds)
DEBOUNCE_INTERVAL=10

# List of interfaces to EXPLICITLY ignore (Space-separated)
# Example: EXCLUDE_INTERFACES="rmnet_data1 rmnet_data8"
EXCLUDE_INTERFACES=""

# Additional IP ranges to bypass (Space-separated CIDR)
# Example: CUSTOM_BYPASS_LIST="1.2.3.4/32 10.20.30.0/24"
CUSTOM_BYPASS_LIST=""

# Use Connection Tracking (conntrack) & Stateful Optimization: 0=Disable, 1=Enable
# Highly recommended for kernels > 4.19 (REPLY bypass) and > 5.10 (Fast-Track).
ENABLE_CONNTRACK=1

# Bypass inbound traffic on WAN interfaces (SMS/VoLTE fix): 0=Disable, 1=Enable
WAN_INBOUND_BYPASS=1

# Advanced: TCP MSS Clamping to fix carrier network connectivity: 0=Disable, 1=Enable
MSS_CLAMP_ENABLE=1